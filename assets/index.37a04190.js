const wt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}};wt();const E=document.getElementById("root"),p=t=>document.querySelector(t),i=(t,e={})=>{const o=document.createElement(t);return Object.entries(e).forEach(([n,s])=>{if(n==="class")return o.classList.add(...s);if(n==="dataset"){Object.entries(s).forEach(([r,a])=>{o.dataset[r]=a});return}if(n==="text")return o.innerText=s;if(n==="html")return o.innerHTML=s;o.setAttribute(n,s)}),o},U=`<svg width="10em" height="10em" role="status" class="inline  text-gray-200 animate-spin dark:text-gray-600 fill-red-600" viewBox="0 0 100 101" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z" fill="currentColor"/>
<path d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z" fill="currentFill"/>
</svg>`,xt=`<svg xmlns="http://www.w3.org/2000/svg" class="menu w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
<path id='hamburger' class=""  stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
<path id="cross" class="hidden"  stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
</svg>`,yt=`<svg width="10em" height="10em" xmlns="http://www.w3.org/2000/svg" class="inline fill-blue-700" viewBox="0 0 20 20" fill="currentColor">
<path fill-rule="evenodd" d="M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd" />
</svg>`,Lt=`<svg width="10em" height="10em" xmlns="http://www.w3.org/2000/svg" class="inline fill-teal-700" viewBox="0 0 20 20" fill="currentColor">
<path d="M2 10.5a1.5 1.5 0 113 0v6a1.5 1.5 0 01-3 0v-6zM6 10.333v5.43a2 2 0 001.106 1.79l.05.025A4 4 0 008.943 18h5.416a2 2 0 001.962-1.608l1.2-6A2 2 0 0015.56 8H12V4a2 2 0 00-2-2 1 1 0 00-1 1v.667a4 4 0 01-.8 2.4L6.8 7.933a4 4 0 00-.8 2.4z" />
</svg>`,kt=`<svg width="10em" height="10em" xmlns="http://www.w3.org/2000/svg" class="inline fill-red-700" viewBox="0 0 20 20" fill="currentColor">
  <path d="M18 9.5a1.5 1.5 0 11-3 0v-6a1.5 1.5 0 013 0v6zM14 9.667v-5.43a2 2 0 00-1.105-1.79l-.05-.025A4 4 0 0011.055 2H5.64a2 2 0 00-1.962 1.608l-1.2 6A2 2 0 004.44 12H8v4a2 2 0 002 2 1 1 0 001-1v-.667a4 4 0 01.8-2.4l1.4-1.866a4 4 0 00.8-2.4z" />
</svg>`,G=`<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
</svg>`,Ct=`<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
<path stroke-linecap="round" stroke-linejoin="round" d="M13 5l7 7-7 7M5 5l7 7-7 7" />
</svg>`,jt=`<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
<path stroke-linecap="round" stroke-linejoin="round" d="M11 19l-7-7 7-7m8 14l-7-7 7-7" />
</svg>`,Tt=xt;function Et(){const t=i("button");return t.classList.add("block","text-center","text-blue-200","border","rounded-lg","border-blue-200","hover:scale-110"),t.type="button",t.id="menuBtn",t.innerHTML=`${Tt}`,t}function zt(){const t=i("div");t.classList.add("flex","text-center","justify-between","items-center","text-blue-200","font-semibold","sm:text-lg","text-xs","space-x-2");const e=i("div");e.id="page_title",e.classList.add("grow");const o=i("div");o.id="action";const n=i("div");return n.classList.add("sm:flex","hidden"),n.innerHTML=`${G}<span class="hidden sm:inline">Rgc Ingenieria</span>`,t.append(Et(),e,o,n),t}function Mt(t,e){const o=i("a");return o.classList.add("block","px-3","py-1","font-semibold","text-blue-200","rounded","hover:bg-red-900","w-auto"),o.href=`${t}`,o.textContent=e,o}function V(){const t=i("div");return t.classList.add("text-center","text-6xl","text-orange-700","bg-orange-200"),t.innerText="Home Site Deployed",t}function v(t,e,o,n=""){const s={class:["block","text-gray-700","w-full"],for:t,text:o.toUpperCase()},r={class:["block","w-full","focus:outline-none","pl-1","text-gray-500","border","rounded","border-gray-500","focus:border-blue-500","focus-border-1","focus:ring-1","focus:ring-blue-500"],type:e,name:t,id:t,value:n},a=i("label",s),c=i("input",r);return a.append(c),a}const Ft=(t,e)=>(t.forEach(o=>{o.val===e&&(o.sel="selected")}),t);function St(t,e){return Ft(t,e).map(s=>`<option value="${s.val}" ${s.sel}>${s.title}</option>`).join("").toString()}function q(t,e,o,n){const s=i("label");s.setAttribute("for",t),s.classList.add("block","text-gray-700"),s.innerText=e;const r=i("select");return r.classList.add("block","focus:outline-none","pl-1","text-gray-500","border","rounded","border-gray-500","focus:border-blue-500","focus:border-1","focus:ring-1","focus:ring-blue-500"),r.id=t,r.name=t,r.value=n,r.classList.add("text-xl"),r.innerHTML=St(o,n),s.append(r),s}function It(t){const o=[{name:"save",action:"button",bGColor:"bg-teal-500",borderColor:"border-teal-800",activeColor:"active:bg-teal-800",path:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />',title:"Guardar"},{name:"search",action:"submit",bGColor:"bg-teal-500",borderColor:"border-teal-800",activeColor:"active:bg-teal-800",path:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />',title:"Search"},{name:"cancel",action:"button",bGColor:"bg-red-500",borderColor:"border-red-800",activeColor:"active:bg-red-800",path:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />',title:"Cancelar"},{name:"upload",bGColor:"bg-sky-500",borderColor:"border-sky-800",activeColor:"active:bg-sky-800",path:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />',title:"Subir"},{name:"download",bGColor:"bg-sky-500",borderColor:"border-sky-800",activeColor:"active:bg-sky-800",path:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10" />',title:"Bajar"}].find(u=>u.name===t);if(!o)return console.log(`no hay boton ${t}`);const n=`<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mx-auto sm:hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">${o.path}</svg>`,{bGColor:s,title:r,borderColor:a,activeColor:c,action:d}=o;return{bGColor:s,title:r,borderColor:a,activeColor:c,icono:n,action:d}}function C(t){const e=It(t.type);if(!e)return;const{bGColor:o,title:n,borderColor:s,activeColor:r,icono:a,action:c}=e,d=i("button");return d.setAttribute("type",c),d.classList.add("h-12","w-12","px-2","sm:w-20","sm:h-8",o,"flex","items-center","rounded-full","border-1",s,"text-white","sm:rounded","hover:scale-110","focus:outline-none","truncate",r),d.innerHTML=`${a}<span class="mx-auto hidden sm:block truncate ">${n}</span>`,d.addEventListener("click",t.cb),d}const Q="https://projectquotteapi.herokuapp.com",J="cotizaciones",Z="cotizacion",K="proyectos",F="proyectos/",At="proyecto/",Dt="findproyectos",Bt="signed",Pt="addfoto",Ht="crear_reporte",Ot="https://bucket-fotos-proyectos.s3.amazonaws.com/";function Rt(){const e=i("div",{id:"loader",class:["text-center","w-1/6","mt-16","fixed","mx-auto","inset-x-0","z-10","hidden"]});return e.innerHTML=`${U}`,e}function W(){p("#loader").classList.remove("hidden")}function X(){p("#loader").classList.add("hidden")}async function L(t,e){const o={method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(e)};W();const n=await fetch(`${Q}/${t}`,o);return n&&X(),n.json()}async function j(t){W();const o=await(await fetch(`${Q}/${t}`)).json();return console.log(o),o&&X(),o.length===1?o[0]:o}async function Y(t){const e=new FormData(t);if(!e)return t;const o=Object.fromEntries(e.entries());return console.log(o),o}const Nt=[{alert:"apendeje",bg:"bg-red-600",txt:"text-red-200"},{alert:"bien",bg:"bg-teal-600",txt:"text-teal-200"},{alert:"exitoPry",bg:"bg-teal-600",txt:"text-teal-200"},{alert:"upLoadGood",bg:"bg-teal-600",txt:"text-teal-200"},{alert:"wrongUpload",bg:"bg-red-600",txt:"text-red-200"}];function x(t,e,o="/"){const{bg:n,txt:s}=_t(t),r=p("#alert");return r.classList.add(n,s),r.classList.toggle("hidden"),r.innerText=e,setTimeout(()=>{r.classList.toggle("hidden"),r.classList.remove(n,s),location.hash=o},1e3)}function _t(t){return Nt.find(o=>o.alert===t)}async function Ut(t,e){const o=await Y(t);console.log("savedata",o);try{const n=e==="Nueva"?await L(J,o):await L(`${Z}/${e}`,o);if(e==="Nueva"&&o.status==="ganada"&&o.sitios>0){console.log("INSIDEIF");const r=await L(`${K}/${n.cotizacionId}`,{});x("bien",`se capturo${n.message}-${r.message}`);return}const s=await L(`${K}/${n.cotizacionId}`,{});e==="Nueva"?x("bien",`Se capturo ${n.message}`):x("bien",`${n.message}`);return}catch(n){x("apendeje",n.message),console.log("ERRORSAVE",n)}}function Gt(t,e){const o=i("div");o.classList.add("flex","justify-between","mx-10","py-2");const n=C({type:"save",cb:async r=>(r.preventDefault(),Ut(t,e))}),s=C({type:"cancel",cb:()=>t.reset()});return o.append(s,n),o}function Vt(t){const e=i("h4");return e.classList.add("text-center","text-xl","text-gray-700"),e.setAttribute("value",""),e.innerText=`Cotizacion ${t}`,e}function y(t){var e=new Date(t),o=""+(e.getMonth()+1),n=""+e.getDate(),s=e.getFullYear();return o.length<2&&(o="0"+o),n.length<2&&(n="0"+n),[s,o,n].join("-")}function tt(t,e,o,n){switch(t){case"ganada":o.classList.remove("hidden"),e.classList.add("hidden"),n.classList.remove("hidden");break;case"terminada":o.classList.remove("hidden"),e.classList.add("hidden"),n.remove("hidden");break;case"cancelada":o.classList.remove("hidden"),e.classList.add("hidden"),n.classList.add("hidden");break;case"pendiente":o.classList.add("hidden"),e.classList.remove("hidden"),n.classList.add("hidden")}}function k(...t){const o=i("fieldset",{class:["sm:flex","space-x-2","sm:justify-center","sm:items-center","w-auto","mx-2"]});return o.append(...t),o}const qt=[{val:"pendiente",title:"Pendiente",sel:""},{val:"ganada",title:"Ganada",sel:""},{val:"cancelada",title:"Cancelada",sel:""},{val:"terminada",title:"Terminada",sel:""}];async function S(){const t={cotizacionId:"Nueva",cliente:"",contacto:"",trabajo:"",sitios:"",cotizador:"",monto:"",status:"pendiente",emision:"",resuelta:"",pedido:""},e=location.hash==="#/modifica"?JSON.parse(localStorage.getItem("cotId")):t;return Qt(e)}async function Qt(t){const e=i("form");e.classList.add("bg-blue-100","rounded-lg","space-y-2","sm:w-2/3","p-2","rounded","mx-auto"),e.setAttribute("autocomplete","off");const o=Vt(t.cotizacionId);o.setAttribute("value",t.cotizacionId);const n=v("contacto","text","Contacto",t.contacto),s=v("cliente","text","Cliente",t.cliente),r=k(s,n),a=v("trabajo","text","Descripcion Trabajo",t.trabajo),c=v("sitios","number","Sitios",t.sitios),d=v("cotizador","text","Cotizador",t.cotizador),u=v("monto","number","Monto $",t.monto),l=k(c,u,d),f=v("pedido","text","Pedido",t.pedido),g=v("emision","date","emision",y(t.emision)),b=v("resuelta","date","Resolucion",y(t.resuelta)),m=q("status","Status",qt,t.status),w=k(m,g,b,f);e.addEventListener("change",O=>{tt(O.target.value,g,b,f)}),tt(t.status,g,b,f);const H=Gt(e,t.cotizacionId);return e.append(o,r,a,l,w,H),e}function Jt(t){const e=t.target.src,o=t.target.dataset.tipo,n={x:e,tipo:o};return t.dataTransfer.setData("text",JSON.stringify(n)),e}function Zt(){}function Kt(t){t.preventDefault()}function Wt(t){t.preventDefault(),this.classList.add("opacity-50")}function Xt(t){this.classList.remove("opacity-50")}function Yt(t){t.preventDefault();const e=JSON.parse(t.dataTransfer.getData("text")),o=t.target.closest("img");if(!o)return this.classList.remove("opacity-50");o.src=e.x,o.dataset.tipo=e.tipo,this.classList.remove("opacity-50")}function et(t,e){const o=i("section");o.classList.add("w-1/6","print:hidden");const n=i("section");n.classList.add("overflow-auto","h-screen","space-y-2");const s=i("p");s.classList.add("text-center","mb-2"),s.innerText=e;const r=t.map(a=>{const c=i("figure");c.dragable=!0,c.classList.add("cursor-pointer","hover:scale-125");const d=i("img");return d.classList.add("border","border-4","border-black","rounded-xl"),d.src=`${Ot}${a}`,d.dataset.tipo=e.toLowerCase(),d.classList.add("hover:scale-125"),c.append(d),c});return n.addEventListener("mousedown",a=>{const c=a.target.closest("img");!c||(c.addEventListener("dragstart",Jt),c.addEventListener("dragend",Zt))},!0),n.append(...r),o.append(s,n),o}function te(){const t=i("section");t.classList.add("flex","flex-wrap","space-y-2");const e=i("div");e.classList.add("flex","w-full","space-x-2");const o=i("div");o.classList.add("flex","w-full","space-x-2");const n=I("Inicio 1","grupo1"),s=I("Final 1","grupo1"),r=I("Inicio 2","grupo2"),a=I("Final 2","grupo2");return e.append(n,s),o.append(r,a),t.append(e,o),t}function I(t,e){document.body.style.webkitTouchCallout="none";const o=i("figure");o.dataset.grp=e;const n=i("figcaption"),s=i("p");s.innerText=t,n.classList.add("flex","justify-between","items-center","mt-2","px-2","w-full");const r=i("img",{src:"foto.svg",class:["object-scale-down","mx-auto","h-64","mb-2"],dataset:{grp:`${e}-${t.toLowerCase().replace(/\s/g,"-")}`}}),a=C({type:"cancel",cb:()=>r.src="foto.svg"});return a.classList.add("mb-2","print:hidden"),o.classList.add("w-1/2","flex","flex-col","border-black","border-2","rounded-lg","shrink"),n.append(s,a),o.append(n,r),o.addEventListener("dragover",Kt),o.addEventListener("dragenter",Wt),o.addEventListener("dragleave",Xt),o.addEventListener("drop",Yt),o}function z(t=""){const e=p("#page_title");if(typeof t=="string")return e.innerHTML=t;if(typeof t=="object")return e.append(t)}async function ot(){const[t,e,o,n]=location.hash.split("/");ee(`${o}-${n}`);const s=await j(`${F}${o}/${n}`),{fotosEmpezar:r,fotosTerminar:a,sitio:c}=s;if(r.length<2||a.length<2)return x("apendeje","No Hay Fotos",`/upfotos/${o}/${n}/${c}`);const d=et(r,"Inicio"),u=et(a,"Final"),l=i("div"),f=i("section");f.id="creareporte",f.classList.add("mt-1","flex","px-2","space-x-2","fixed","items-start","print:justify-around","print:absolute");const g=p("#preview"),b=te();return g.addEventListener("click",w=>{window.print()}),p("#save").addEventListener("click",()=>{oe(b,o,n)}),f.append(d,b,u),l.append(f),l}function ee(t){const e=`<div class="flex justify-evenly"><p>Proyecto: ${t}</p><button type="button" id="preview" class="bg-orange-500  w-20 text-xs rounded">Preview</button></p><button type="button" id="save" class="bg-blue-500  w-20 text-xs rounded">Save</button></div>`;return z(e)}async function oe(t,e,o){const n={grupo1:{},grupo2:{}},s=t.querySelectorAll("img");console.log([...s]),[...s].forEach(c=>{const[d,u,l]=c.dataset.grp.split("-");n[d][u]=c.src});const a={cotizacionId:e,proyectoId:o,reporte:n};return console.log(a),await L(Ht,a),location.hash=`/ver_reporte/${e}/${o}`}async function nt(t){const e=await j(`${Z}/${t}`);if(e.error){x("apendeje",`Apendeje: ${e.message}`);return}return localStorage.setItem("cotId",JSON.stringify(e)),location.hash="/modifica"}const ne=`<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
</svg>`;function st(t,e="..."){const o=i("div");o.classList.add("flex","border","rounded-lg","border-gray-500","mb-2");const n=i("input");n.classList.add("w-full","focus:outline-none","pl-1","text-gray-500","rounded-l-lg","border-gray-500","focus:border-blue-500","focus-border-1","focus:ring-1","focus:ring-blue-500"),n.id="search",n.autofocus=!0,n.required=!0,n.placeholder=e,n.autocomplete="off";const s=i("button");return s.innerHTML=`${ne}`,s.classList.add("h-8","w-8","bg-sky-400","rounded-r-lg","flex","items-center","justify-center","text-white"),s.addEventListener("click",t),n.addEventListener("change",t),o.append(n,s),o}function rt(){const t=i("section");t.classList.add("sm:w-1/3","mx-auto");const e=()=>nt(p("#search").value);return t.append(st(e)),t}function at(){const e=i("section",{class:["mx-2","grid","gap-2","grid-cols-1","sm:grid-cols-1","md:grid-cols-2","lg:grid-cols-3"]});return e.addEventListener("click",async o=>{if(o.target.dataset.cot){const n=o.target.dataset.cot;return await nt(n)}if(o.target.dataset.cliente)return location.hash=`/cotizaciones/${o.target.dataset.cliente}`;if(o.target.dataset.sitcot){const n=o.target.dataset.sitcot;return location.hash=`/proyectosencotizacion/${n}`}if(o.target.dataset.pry)return location.hash=`/mod-proyecto/${o.target.dataset.pry}`;if(o.target.dataset.reporte){const n=o.target.dataset.reporte;location.hash=`/ver_reporte/${n}`}if(o.target.dataset.crear){const n=o.target.dataset.crear;console.log("ENDPOINT",n),location.hash=`/reporte/${n}`}if(o.target.dataset.subir){const n=o.target.dataset.subir;console.log("ENDPOINT",n),location.hash=`/upfotos/${n}`}}),e}function M(t,e){const n=i("button",{class:["text-blue-900","hover:text-white","focus:text-white","bg-blue-400","hover:bg-blue-500","focus:ring-4","focus:ring-blue-300","font-medium","rounded-full","text-xs","px-2","text-center","mx-2","mb-2","h-6","w-1/3","border-b-2","border-r-2","border-blue-900","truncate"],dataset:e});return n.innerText=t,n}function $(...t){const o=i("div",{class:["pt-2","flex","justify-between"]});return o.append(...t),o}function h(t,e){const o={class:["mx-2","mb-2","space-y-1","bg-blue-800","p-2","rounded","w-full","text-white","text-xs"]},n={text:t},s={text:e},r=i("div",o),a=i("p",n),c=i("p",s);return r.append(a,c),r}function A(){return i("section",{class:["w-full","mx-auto","space-y-2","bg-slate-200","rounded-lg","border-2","border-blue-500"]})}function se(t){const{cotizacionId:e,cliente:o,contacto:n,trabajo:s,sitios:r,cotizador:a,monto:c,status:d,emision:u,resuelta:l,pedido:f}=t,g=A(),b=$(M(`Cot: ${e}`,{cot:e}),M(`${o}`,{cliente:o}),M(`Sitios ${r}`,{sitcot:e})),m=$(h("Trabajo:",`${s}`));m.classList.add("w-full");const w=$(h("Status:",`${d}`),h("Emision",`${y(u)}`),h("Resolucion:",`${y(l)}`));return g.append(b,m,w),g}async function D(t){const e=t||"";z(e!==""?`Cotizaciones de ${e}`:"Todas las Cotizaciones ");const o=await j(`${J}/${e}`),n=o.length>0?o:[o],s=at(),r=n.map(a=>se(a));return s.append(...r),s}function re(t){const e=A(),o=t.reporte.length,n=t.fotosEmpezar.length,s=t.fotosTerminar.length;console.log("EMPEZAR",n,"FINAL",s);const r=`${t.cotizacionId}/${t.proyectoId}/${t.sitio}`,a=o>0?"reporte":n>=2&&s>=2?"crear":"subir",c=$(M(`Pry: ${t.cotizacionId}-${t.proyectoId}`,{pry:`${t.cotizacionId}/${t.proyectoId}`}),M(`Reporte(${o})`,{[a]:r})),d=$(h("Sitio",t.sitio),h("Supervisor",t.supervisor)),u=$(h("Direccion",t.direccion)),l=$(h("Status",t.status),h("Inicio",y(t.inicio))),f=$(h("Terminado",y(t.terminado)),h("Factura",t.factura));return e.append(c,d,u,l,f),e}async function it(t){const e=await j(`${F}${t}`),o=e.length>0?e:[e],n=at(),s=o.map(r=>re(r));return z(`Trabajo: ${o[0].trabajo} <br class="sm:hidden"><span class="ml-4">Cliente: ${o[0].cliente}</span>`),n.append(...s),n}function ct(t){return i("h4",{class:["mx-2","py-1","text-center","rounded","bg-blue-800","text-white","w-1/2"],text:t})}function dt(t,e,o){t!=="terminado"?(e.classList.add("hidden"),o.classList.add("hidden")):(e.classList.remove("hidden"),o.classList.remove("hidden"))}async function ae(t,e,o){const n=await Y(o);try{const s=await L(`${At}${t}/${e}`,n);x("bien",`Proyecto ${t}-${e} ${s.message}`,`/proyectosencotizacion/${t}`);return}catch(s){x("apendeje",`Apendeje : ${s.message}`)}}const ie=[{val:"pendiente",title:"Pendiente"},{val:"proceso",title:"Proceso"},{val:"terminado",title:"Terminado"}];async function lt(){const[t,e,o,n]=location.hash.split("/"),s=await j(`${F}${o}/${n}`),r=$(ct(`Proyecto: ${o}-${n}`),ct(`Cliente: ${s.cliente}`)),a=$(h("Trabajo",s.trabajo)),c=k(v("sitio","text","Sitio",s.sitio),v("direccion","text","direccion",s.direccion)),d=k(v("supervisor","text","supervisor",s.supervisor),q("status","Status",ie,s.status),v("inicio","date","Inicio",y(s.inicio))),u=v("terminado","date","Terminacion",y(s.terminado)),l=v("factura","text","factura",s.factura),f=k(u,l),g=$(C({type:"cancel",cb:()=>console.log("BTN")}),C({type:"save",cb:async w=>(w.preventDefault(),ae(o,n,m))})),b=A(),m=i("form");return b.classList.add("sm:w-2/3"),m.classList.add("space-y-2","p-2","mx-auto"),m.setAttribute("autocomplete","off"),m.append(c,d,f,g),m.addEventListener("change",w=>{dt(m.status.value,u,l)}),b.append(r,a,m),dt(m.status.value,u,l),b}function ce(t){const o=i("section",{class:["space-y-2"],id:"top"}),n=t.map((s,r)=>{const{cotizacionId:a,proyectoId:c,sitio:d,direccion:u}=s,l=A();l.classList.add("cursor-pointer"),l.dataset.cardnum=r,l.dataset.pry=`${a}/${c}/${d}`;const f=$(h("Proyecto",`${a}-${c}`),h("Sitio",`${d}`)),g=$(h("Direccion",`${u}`));return l.append(f,g),l});return o.append(...n),o.addEventListener("click",s=>{const r=parseInt(s.target.closest("section").dataset.cardnum,10),a=s.target.closest("section").dataset.pry;a&&location.hash.includes("fotos")&&(location.hash=`/upfotos/${a}`),a&&location.hash.includes("make_report")&&(localStorage.setItem("pry",JSON.stringify(t[r])),location.hash=`/reporte/${a}`)}),o}function B(t){const e=i("section");e.classList.add("sm:w-1/2","mx-auto");const o=async()=>{const n=p("#search").value;if(p("#top")&&p("#top").remove(),!n)return;const s=await j(`${Dt}?val=${n}`),r=s.length>1?s:[s],a=ce(r);e.append(a)};return e.append(st(o)),e}function ut(t="foto",e="final",o=!1){const n=i("div");n.classList.add("flex","items-center","space-x-8","bg-blue-700","rounded-full","text-sm","h-8","pr-2");const s=i("label"),r=i("input");return r.type="radio",r.name=t,r.id=e,r.value=e,r.classList.add("w-4","h-4","accent-red-600"),r.checked=o,s.setAttribute("for",e),s.classList.add("ml-4"),s.innerText=e.toUpperCase(),n.append(s,r),n}function de(t){const e=p("figure"),o=p("#imgdiv"),n=p("#btnbar");o.classList.add("hidden"),n.classList.remove("invisible"),e.innerHTML=`<img src="${t.target.result}">`}function le(){const t=i("div");t.id="imgdiv",t.classList.add("flex","justify-center");const e=i("input");e.type="file",e.id="foto",e.name="foto",e.classList.add("hidden");const o=i("label");return o.setAttribute("for","foto"),o.innerHTML=yt,o.classList.add("block","flex","items-center","justify-center","w-24","h-24","rounded-full","border","border-black","cursor-pointer"),e.addEventListener("change",async n=>{const s=await n.target.files[0];if(!s)return;const r=new FileReader;r.readAsDataURL(s),r.addEventListener("load",de,!1)}),o.append(e),t.append(o),t}async function ue(t,e){console.log("FILE",e.type);const o=new FormData;return Object.keys(t).forEach(n=>o.append(n,t[n])),o.append("Content-type",e.type),o.append("file",e),o}async function pe(t,e){const o={method:"POST",body:e};try{return await fetch(t,o)}catch(n){return await n.json()}}function fe(t){const e=[...t.getElementsByTagName("input")],[o]=e.filter(n=>n.checked);return o?o.value:Error("te Apendejaste falta foto tipo")}async function ge(t,e,o,n){const s={cotizacionId:t,proyectoId:e,fileName:n.name};try{const r=fe(o);if(!["empezar","terminar"].includes(r))throw Error(r.message);const a=await L(Bt,s);if(a.statusCode)throw Error(a.message);const{url:c,fields:d}=a,u=await ue(d,n),l=await pe(c,u);if(console.log(l),!l.ok)throw Error("error al subir foto");const f={cotizacionId:t,proyectoId:e,tipo:r,laFoto:d.key};return console.log("MONGO",f),await L(Pt,f)}catch(r){return r}}function pt(t,e){const o=p("figure"),n=p("#imgdiv"),s=p("#btnbar"),r=p("#upfotos");s.classList.add("invisible"),t==="positive"&&(o.innerHTML=`${Lt}<p class="text-teal-700">${e}!!!</p>`),t==="negative"&&(o.innerHTML=`${kt}<p class="text-red-700">!!!${e}</p>`),setTimeout(()=>{r.reset(),o.innerHTML=null,n.classList.remove("hidden")},1500)}async function me(t,e){const{cotizacionId:o,proyectoId:n,$radioBar:s}=e,r=new FileReader;r.readAsDataURL(t);const a=i("canvas"),c=a.getContext("2d"),d=i("img");d.id="small",d.classList.add("hidden"),r.addEventListener("load",u=>{d.src=u.target.result}),d.addEventListener("load",async u=>{const l=400,f=p("#imgcontainer"),{width:g,height:b}=u.target,m=b/g,w=g>l?l:g,H=w*m;a.width=w,a.height=H,c.drawImage(u.target,0,0,a.width,a.height);const O=c.canvas.toDataURL("image/webp"),vt=await(await fetch(O)).blob(),$t=new File([vt],"CHIQUITO.webp",{type:"image/webp"});f.innerHTML=U;const{message:R}=await ge(o,n,s,$t);R.includes("agregado")?pt("positive",R):pt("negative",R)})}function ft(){z("Captura de Fotos");const[t,e,o,n,s]=location.hash.split("/"),r=le(),a=i("figure");a.id="imgcontainer",a.classList.add("text-center","mx-auto"),a.innerHTML=null;const c=i("form");c.id="upfotos",c.autocomplete="off",c.classList.add("mx-2","mt-2","sm:w-2/3","sm:mx-auto","space-y-8","bg-blue-100","border-blue-500","text-white","rounded-lg");const d=h("Proyecto : ",`${o}-${n}`),u=h("Sitio :",decodeURI(s)),l=$(d,u),f=k(ut("foto","empezar"),ut("foto","terminar"));f.classList.add("flex","justify-center","space-x-2");const g=k(C({type:"cancel",cb:()=>{c.reset(),a.innerHTML=null,r.classList.remove("hidden"),g.classList.add("invisible")}}),C({type:"save",cb:async b=>{const m=p("#foto").files[0];await me(m,{cotizacionId:o,proyectoId:n,$radioBar:f})}}));return g.id="btnbar",g.classList.add("flex","justify-center","space-x-12","invisible"),c.append(l,f,r,a,g),c}const T={currentVal:1};function he(t,e){T.Max=t;const o={class:["flex","space-x-1","border","border-black","rounded-lg","mr-6","p-2"]},n={html:jt,id:"minus"},s={html:Ct,id:"plus"},r={class:["w-6","h-6","mb-1","rounded","text-center","text-blue-800"],id:"contador",type:"text",value:1},a=i("div",o),c=i("button",s),d=i("input",r),u=i("button",n);return c.addEventListener("click",l=>gt(l,e)),u.addEventListener("click",l=>gt(l,e)),a.append(u,d,c),a}function gt(t,e){let o=0;t.target.closest("#plus")&&(o=1),t.target.closest("#minus")&&(o=-1);const n=p("#reporte"),s=p("#fecha"),r=p("#contador"),a=be(o);n.innerText=`Reporte # ${a}`,r.value=a,s.innerText=` Fecha: ${y(e[a-1].header.createdDate)}`;for(const c in e[a-1]){if(c==="header")break;for(const d in e[a-1][c]){const u=p(`#${c}-${d}`);u.src=e[a-1][c][d]}}}function be(t){let e=T.currentVal+t;return e>T.Max&&(e=1),e<1&&(e=T.Max),T.currentVal=e,T.currentVal}function ve([t,...e]){return[t.toUpperCase(),...e].join("")}function $e(t=1,e){const o=t-1,n=i("section",{class:["space-y-2","pb-2","border-b-2","border-black"]}),s=i("p",{html:`${G} RgcIngenieria`,class:["flex","text-sm","ml-2"]}),r=i("h4",{text:"Reporte Fotografico",class:["text-lg","text-center"]}),a=N({proyecto:`${e.cotizacionId}-${e.proyectoId}`},{reporte:t},{sitio:e.sitio},{trabajo:e.trabajo}),c=N({cliente:e.cliente},{pedido:e.pedido},{contacto:e.contacto}),d=N({supervisor:e.supervisor},{factura:e.factura}),u=i("p",{id:"fecha",text:`Fecha: ${y(e.reporte[o].header.createdDate)}`,class:["text-sm","mr-2"]}),l=i("div",{class:["flex","justify-between"]});return l.append(s,u),n.append(l,r,a,c,d),n}function N(...t){const e=i("div",{class:["flex","justify-evenly"]}),o=t.map(n=>{const[s]=Object.entries(n);return i("p",{id:`${s[0]}`,class:["text-sm","truncate"],text:`${ve(s[0])}: ${s[1]}`})});return e.append(...o),e}async function mt(){const[t,e,o,n,s,r]=location.hash.split("/"),a=r?parseInt(r,10)-1:0,c=await j(`${F}${o}/${n}`),{reporte:d}=c;if(c.fotosEmpezar<2||c.fotosTerminar<2)return x("apendeje","Fotos Incompletas",`/upfotos/${o}/${n}/${s}`);if(d.length<1)return x("apendeje","No Hay reportes",`/reporte/${o}/${n}`);const u=p("#action"),l=i("section",{id:"reporte-total",class:["space-y-2","mx-2"]});return u.append(he(d.length,d)),l.append($e(1,c),...we(d[a])),l}function we(t){const e=[];for(const o in t){if(o==="header")break;const n=i("section",{class:["flex","justify-between","space-x-2"],id:o}),s=[];for(const r in t[o]){const a=i("figure",{class:["w-1/2","border-black","border-2","rounded-lg","shrink"]}),c=i("img",{src:`${t[o][r]}`,class:["object-scale-down","mx-auto","h-64","mb-2"],id:`${o}-${r}`}),d=i("figcaption",{text:`Foto ${r.toUpperCase()} ${e.length+1}`,class:["ml-2"]});a.append(d,c),s.push(a)}n.append(...s),e.push(n)}return e}const xe=[{link:"#/",titulo:"Home",cb:V},{link:"#/cotizacion",titulo:"Nueva Cotizacion",cb:async()=>S()},{link:"#/mod-cot",titulo:"Modificar Cotizacion",cb:async()=>rt()},{link:"#/modifica",titulo:"",cb:async t=>S()},{link:"#/cotizaciones",titulo:"Listado Cotizaciones",cb:(t="")=>D(t)},{link:"#/cotizacionesxcliente",titulo:"",cb:()=>D()},{link:"#/proyectosencotizacion",titulo:"",cb:t=>it(t)},{link:"#/mod-proyecto",titulo:"",cb:t=>lt()},{link:"#/fotos",titulo:"Agregar Fotos",cb:()=>B()},{link:"#/upfotos",titulo:"",cb:()=>ft()},{link:"#/make_reporte",titulo:"Reporte Final",cb:()=>B()},{link:"#/reporte",titulo:"",cb:()=>ot()},{link:"#/ver_reporte",titulo:"",cb:async()=>await mt()}];function ye(){const t=i("nav");return t.classList.add("hidden","w-auto","fixed","mt-2","left-0","bg-blue-800","space-y-2"),t.id="navLinks",xe.forEach(e=>{e.titulo!==""&&t.append(Mt(e.link,e.titulo))}),t}function Le(){const t=i("header");return t.classList.add("bg-blue-800","h-16","px-2","pt-4","fixed","inset-x-0","top-0","z-10","print:hidden"),t.append(zt(),ye()),t}const _=document.getElementById("root"),ke=(t,e={})=>{const o=document.createElement(t);return Object.entries(e).forEach(([n,s])=>{if(n==="class")return o.classList.add(...s);if(n==="dataset"){Object.entries(s).forEach(([r,a])=>{o.dataset[r]=a});return}if(n==="text")return o.innerText=s;if(n==="html")return o.innerHTML=s;o.setAttribute(n,s)}),o};function Ce(t=""){const e=ke("div");return e.id="alert",e.classList.add("h-16","rounded","border","text-center","text-xl","hidden","fixed","left-1/4","top-1/4","w-1/2","z-10"),e.innerText=t,e}async function P(t){const e=i("section");return e.id="content",e.classList.add("mt-16","w-full","print:mt-0"),typeof t=="object"&&e.append(t),e}function je(){const t=i("div");return t.classList.add("text-center","text-6xl","text-blue-500"),t.innerText="Te Chingas Not found PlaceHolder",t}const ht=[{link:"#/",titulo:"Home",cb:V},{link:"#/cotizacion",titulo:"Nueva Cotizacion",cb:async()=>S()},{link:"#/mod-cot",titulo:"Modificar Cotizacion",cb:async()=>rt()},{link:"#/modifica",titulo:"",cb:async t=>S()},{link:"#/cotizaciones",titulo:"Listado Cotizaciones",cb:(t="")=>D(t)},{link:"#/cotizacionesxcliente",titulo:"",cb:()=>D()},{link:"#/proyectosencotizacion",titulo:"",cb:t=>it(t)},{link:"#/mod-proyecto",titulo:"",cb:t=>lt()},{link:"#/fotos",titulo:"Agregar Fotos",cb:()=>B()},{link:"#/upfotos",titulo:"",cb:()=>ft()},{link:"#/make_reporte",titulo:"Reporte Final",cb:()=>B()},{link:"#/reporte",titulo:"",cb:()=>ot()},{link:"#/ver_reporte",titulo:"",cb:async()=>await mt()}];async function Te(t){if(t==="/"||!t)return E.append(await P(ht[0].cb()));const e=t.split("/"),o=e.length>2?`${e[0]}/${e[1]}`:t,n=ht.find(r=>r.link===o);if(e[2])return E.append(await P(await n.cb(e[2])));if(!n)return E.append(await P(je()));const s=await P(await n.cb());return E.append(s)}const Ee=t=>t.classList.toggle("hidden"),ze=t=>Array.from(t.querySelectorAll("path")).forEach(o=>{o.classList.toggle("hidden")});function Me(){const t=p("#navLinks"),e=p("#menuBtn");E.addEventListener("click",o=>{(!t.classList.contains("hidden")||o.target.closest("#menuBtn")&&!o.target.closest("a"))&&(Ee(t),ze(e))},!0)}function bt(){return _.innerHTML=null,_.append(Le(),Rt()),_.append(Ce()),Me(),Te(window.location.hash)}document.addEventListener("DOMContentLoaded",bt);window.addEventListener("hashchange",bt);
