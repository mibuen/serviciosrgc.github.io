import{E as gt}from"./vendor.1830f5cd.js";const ht=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function o(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=o(s);fetch(s.href,a)}};ht();const L=document.getElementById("root"),p=t=>document.querySelector(t),c=(t,e={})=>{const o=document.createElement(t);return Object.entries(e).forEach(([n,s])=>{if(n==="class")return o.classList.add(...s);if(n==="dataset"){Object.entries(s).forEach(([a,r])=>{o.dataset[a]=r});return}if(n==="text")return o.innerText=s;if(n==="html")return o.innerHTML=s;o.setAttribute(n,s)}),o};function mt(t,e){return c("button",{type:"button",id:t,html:e,class:["text-center","text-blue-200","border","rounded-lg","border-blue-200","hover:scale-110"]})}const U=`<svg width="10em" height="10em" role="status" class="inline  text-gray-200 animate-spin dark:text-gray-600 fill-red-600" viewBox="0 0 100 101" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z" fill="currentColor"/>
<path d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z" fill="currentFill"/>
</svg>`,bt=`<svg xmlns="http://www.w3.org/2000/svg" class="menu w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
<path id='hamburger' class=""  stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
<path id="cross" class="hidden"  stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
</svg>`,vt=`<svg width="10em" height="10em" xmlns="http://www.w3.org/2000/svg" class="inline fill-blue-700" viewBox="0 0 20 20" fill="currentColor">
<path fill-rule="evenodd" d="M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd" />
</svg>`,$t=`<svg width="10em" height="10em" xmlns="http://www.w3.org/2000/svg" class="inline fill-teal-700" viewBox="0 0 20 20" fill="currentColor">
<path d="M2 10.5a1.5 1.5 0 113 0v6a1.5 1.5 0 01-3 0v-6zM6 10.333v5.43a2 2 0 001.106 1.79l.05.025A4 4 0 008.943 18h5.416a2 2 0 001.962-1.608l1.2-6A2 2 0 0015.56 8H12V4a2 2 0 00-2-2 1 1 0 00-1 1v.667a4 4 0 01-.8 2.4L6.8 7.933a4 4 0 00-.8 2.4z" />
</svg>`,wt=`<svg width="10em" height="10em" xmlns="http://www.w3.org/2000/svg" class="inline fill-red-700" viewBox="0 0 20 20" fill="currentColor">
  <path d="M18 9.5a1.5 1.5 0 11-3 0v-6a1.5 1.5 0 013 0v6zM14 9.667v-5.43a2 2 0 00-1.105-1.79l-.05-.025A4 4 0 0011.055 2H5.64a2 2 0 00-1.962 1.608l-1.2 6A2 2 0 004.44 12H8v4a2 2 0 002 2 1 1 0 001-1v-.667a4 4 0 01.8-2.4l1.4-1.866a4 4 0 00.8-2.4z" />
</svg>`,q=`<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
</svg>`,xt=`<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
<path stroke-linecap="round" stroke-linejoin="round" d="M13 5l7 7-7 7M5 5l7 7-7 7" />
</svg>`,yt=`<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
<path stroke-linecap="round" stroke-linejoin="round" d="M11 19l-7-7 7-7m8 14l-7-7 7-7" />
</svg>`,j=await gt({domain:"dev-cyqa-6ur.us.auth0.com",client_id:"yLvAoyzmr7J8DYSIXunDZoMl5N0CZD4m",cacheLocation:"localstorage",audience:"https://projectquotteapi.herokuapp.com"});async function Lt(){if(await j.isAuthenticated()===!0){const e=await j.getUser();return c("img",{class:["rounded-full","w-8","h-8"],src:e.picture})}return!1}async function kt(){const t={class:["flex","text-center","justify-between","items-center","text-blue-200","font-semibold","sm:text-lg","text-xs","space-x-2"]},e={id:"page_title",class:["grow"]},o={id:"action"},n=await Lt(),s={class:["flex"],html:`${q}<span class=" hidden sm:inline">Rgc</span>`},a=c("div",t),r=c("div",e),i=c("div",o),d=c("div",s),l=mt("menuBtn",bt);return a.append(l,r,i),n&&a.append(n),a.append(d),a}function Ct(t,e){const o={href:`${t}`,text:e,class:["block","px-3","py-1","font-semibold","text-blue-200","rounded","hover:bg-red-900","w-auto"]},n=c("a",o);return n.classList.add("block","px-3","py-1","font-semibold","text-blue-200","rounded","hover:bg-red-900","w-auto"),n}function jt(){const t=c("div");return t.classList.add("text-center","text-6xl","text-red-700","bg-orange-200"),t.innerText="Home Que Chingaos Pasa!",t}function v(t,e,o,n=""){const s={class:["block","text-gray-700","w-full"],for:t,text:o.toUpperCase()},a={class:["block","w-full","focus:outline-none","pl-1","text-gray-500","border","rounded","border-gray-500","focus:border-blue-500","focus-border-1","focus:ring-1","focus:ring-blue-500"],type:e,name:t,id:t,value:n},r=c("label",s),i=c("input",a);return r.append(i),r}const Tt=(t,e)=>(t.forEach(o=>{o.val===e&&(o.sel="selected")}),t);function St(t,e){return Tt(t,e).map(s=>`<option value="${s.val}" ${s.sel}>${s.title}</option>`).join("").toString()}function G(t,e,o,n){const s=c("label");s.setAttribute("for",t),s.classList.add("block","text-gray-700"),s.innerText=e;const a=c("select");return a.classList.add("block","focus:outline-none","pl-1","text-gray-500","border","rounded","border-gray-500","focus:border-blue-500","focus:border-1","focus:ring-1","focus:ring-blue-500"),a.id=t,a.name=t,a.value=n,a.classList.add("text-xl"),a.innerHTML=St(o,n),s.append(a),s}function zt(t){const o=[{name:"save",action:"button",bGColor:"bg-teal-500",borderColor:"border-teal-800",activeColor:"active:bg-teal-800",path:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />',title:"Guardar"},{name:"search",action:"submit",bGColor:"bg-teal-500",borderColor:"border-teal-800",activeColor:"active:bg-teal-800",path:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />',title:"Search"},{name:"cancel",action:"button",bGColor:"bg-red-500",borderColor:"border-red-800",activeColor:"active:bg-red-800",path:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />',title:"Cancelar"},{name:"upload",bGColor:"bg-sky-500",borderColor:"border-sky-800",activeColor:"active:bg-sky-800",path:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />',title:"Subir"},{name:"download",bGColor:"bg-sky-500",borderColor:"border-sky-800",activeColor:"active:bg-sky-800",path:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10" />',title:"Bajar"}].find(l=>l.name===t);if(!o)return console.log(`no hay boton ${t}`);const n=`<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mx-auto sm:hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">${o.path}</svg>`,{bGColor:s,title:a,borderColor:r,activeColor:i,action:d}=o;return{bGColor:s,title:a,borderColor:r,activeColor:i,icono:n,action:d}}function T(t){const e=zt(t.type);if(!e)return;const{bGColor:o,title:n,borderColor:s,activeColor:a,icono:r,action:i}=e,d=c("button");return d.setAttribute("type",i),d.classList.add("h-12","w-12","px-2","sm:w-20","sm:h-8",o,"flex","items-center","rounded-full","border-1",s,"text-white","sm:rounded","hover:scale-110","focus:outline-none","truncate",a),d.innerHTML=`${r}<span class="mx-auto hidden sm:block truncate ">${n}</span>`,d.addEventListener("click",t.cb),d}const V="https://projectquotteapi.herokuapp.com",_="cotizaciones",Q="cotizacion",J="proyectos",E="proyectos/",Ft="proyecto/",Mt="findproyectos",Et="signed",It="addfoto",At="crear_reporte",Bt="verReporte/",Dt="https://bucket-fotos-proyectos.s3.amazonaws.com/";function Pt(){const e=c("div",{id:"loader",class:["text-center","w-1/6","mt-16","fixed","mx-auto","inset-x-0","z-10","hidden"]});return e.innerHTML=`${U}`,e}function X(){p("#loader").classList.remove("hidden")}function Z(){p("#loader").classList.add("hidden")}async function k(t,e){X();const o=localStorage.getItem("tkt"),n={method:"POST",headers:{"Content-type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(e)},s=await fetch(`${V}/${t}`,n);return s&&Z(),s.json()}async function S(t){X();const e=localStorage.getItem("tkt"),n=await(await fetch(`${V}/${t}`,{headers:{Authorization:`Bearer ${e}`}})).json();return n&&Z(),n.length===1?n[0]:n}async function K(t){const e=new FormData(t);return e?Object.fromEntries(e.entries()):t}const Rt=[{alert:"apendeje",bg:"bg-red-600",txt:"text-red-200"},{alert:"bien",bg:"bg-teal-600",txt:"text-teal-200"},{alert:"exitoPry",bg:"bg-teal-600",txt:"text-teal-200"},{alert:"upLoadGood",bg:"bg-teal-600",txt:"text-teal-200"},{alert:"wrongUpload",bg:"bg-red-600",txt:"text-red-200"}];function x(t,e,o="/"){const{bg:n,txt:s}=Ht(t),a=p("#alert");return a.classList.add(n,s),a.classList.toggle("hidden"),a.innerText=e,setTimeout(()=>{a.classList.toggle("hidden"),a.classList.remove(n,s),location.hash=o},1e3)}function Ht(t){return Rt.find(o=>o.alert===t)}async function Ot(t,e){const o=await K(t);try{const n=e==="Nueva"?await k(_,o):await k(`${Q}/${e}`,o);if(e==="Nueva"&&o.status==="ganada"&&o.sitios>0){const a=await k(`${J}/${n.cotizacionId}`,{});x("bien",`se capturo${n.message}-${a.message}`);return}const s=await k(`${J}/${n.cotizacionId}`,{});e==="Nueva"?x("bien",`Se capturo ${n.message}`):x("bien",`${n.message}`);return}catch(n){x("apendeje",n.message)}}function Nt(t,e){const o=c("div");o.classList.add("flex","justify-between","mx-10","py-2");const n=T({type:"save",cb:async a=>(a.preventDefault(),Ot(t,e))}),s=T({type:"cancel",cb:()=>t.reset()});return o.append(s,n),o}function Ut(t){const e=c("h4");return e.classList.add("text-center","text-xl","text-gray-700"),e.setAttribute("value",""),e.innerText=`Cotizacion ${t}`,e}function y(t){const e=new Date(t);let o=`${e.getMonth()+1}`,n=`${e.getDate()}`;const s=e.getFullYear();return o.length<2&&(o=`0${o}`),n.length<2&&(n=`0${n}`),[s,o,n].join("-")}function W(t,e,o,n){switch(t){case"ganada":o.classList.remove("hidden"),e.classList.add("hidden"),n.classList.remove("hidden");break;case"terminada":o.classList.remove("hidden"),e.classList.add("hidden"),n.remove("hidden");break;case"cancelada":o.classList.remove("hidden"),e.classList.add("hidden"),n.classList.add("hidden");break;case"pendiente":o.classList.add("hidden"),e.classList.remove("hidden"),n.classList.add("hidden");break}}function C(...t){const o=c("fieldset",{class:["sm:flex","space-x-2","sm:justify-center","sm:items-center","w-auto","mx-2"]});return o.append(...t),o}const qt=[{val:"pendiente",title:"Pendiente",sel:""},{val:"ganada",title:"Ganada",sel:""},{val:"cancelada",title:"Cancelada",sel:""},{val:"terminada",title:"Terminada",sel:""}];async function Y(){const t={cotizacionId:"Nueva",cliente:"",contacto:"",trabajo:"",sitios:"",cotizador:"",monto:"",status:"pendiente",emision:"",resuelta:"",pedido:""},e=location.hash==="#/modifica"?JSON.parse(localStorage.getItem("cotId")):t;return Gt(e)}async function Gt(t){const o=c("form",{class:["bg-blue-100","rounded-lg","space-y-2","sm:w-2/3","p-2","rounded","mx-auto"],autocomplete:"off"}),n=Ut(t.cotizacionId);n.setAttribute("value",t.cotizacionId);const s=v("contacto","text","Contacto",t.contacto),a=v("cliente","text","Cliente",t.cliente),r=C(a,s),i=v("trabajo","text","Descripcion Trabajo",t.trabajo),d=v("sitios","number","Sitios",t.sitios),l=v("cotizador","text","Cotizador",t.cotizador),u=v("monto","number","Monto $",t.monto),g=C(d,u,l),f=v("pedido","text","Pedido",t.pedido),b=v("emision","date","emision",y(t.emision)),h=v("resuelta","date","Resolucion",y(t.resuelta)),w=G("status","Status",qt,t.status),D=C(w,b,h,f);o.addEventListener("change",N=>{W(N.target.value,b,h,f)}),W(t.status,b,h,f);const P=Nt(o,t.cotizacionId);return o.append(n,r,i,g,D,P),o}function Vt(t){const e=t.target.src,{tipo:o}=t.target.dataset,n={x:e,tipo:o};return t.dataTransfer.setData("text",JSON.stringify(n)),e}function _t(){}function Qt(t){t.preventDefault()}function Jt(t){t.preventDefault(),this.classList.add("opacity-50")}function Xt(t){this.classList.remove("opacity-50")}function Zt(t){t.preventDefault();const e=JSON.parse(t.dataTransfer.getData("text")),o=t.target.closest("img");if(!o)return this.classList.remove("opacity-50");o.src=e.x,o.dataset.tipo=e.tipo,this.classList.remove("opacity-50")}function tt(t,e){const o=c("section");o.classList.add("w-1/6","print:hidden");const n=c("section");n.classList.add("overflow-auto","h-screen","space-y-2");const s=c("p");s.classList.add("text-center","mb-2"),s.innerText=e;const a=t.map(r=>{const i=c("figure");i.dragable=!0,i.classList.add("cursor-pointer","hover:scale-125");const d=c("img");return d.classList.add("border","border-4","border-black","rounded-xl"),d.src=`${Dt}${r}`,d.dataset.tipo=e.toLowerCase(),d.classList.add("hover:scale-125"),i.append(d),i});return n.addEventListener("mousedown",r=>{const i=r.target.closest("img");!i||(i.addEventListener("dragstart",Vt),i.addEventListener("dragend",_t))},!0),n.append(...a),o.append(s,n),o}function Kt(){const t=c("section");t.classList.add("flex","flex-wrap","space-y-2");const e=c("div");e.classList.add("flex","w-full","space-x-2");const o=c("div");o.classList.add("flex","w-full","space-x-2");const n=I("Inicio 1","grupo1"),s=I("Final 1","grupo1"),a=I("Inicio 2","grupo2"),r=I("Final 2","grupo2");return e.append(n,s),o.append(a,r),t.append(e,o),t}function I(t,e){document.body.style.webkitTouchCallout="none";const o=c("figure");o.dataset.grp=e;const n=c("figcaption"),s=c("p");s.innerText=t,n.classList.add("flex","justify-between","items-center","mt-2","px-2","w-full");const a=c("img",{src:"foto.svg",class:["object-scale-down","mx-auto","h-64","mb-2"],dataset:{grp:`${e}-${t.toLowerCase().replace(/\s/g,"-")}`}}),r=T({type:"cancel",cb:()=>a.src="foto.svg"});return r.classList.add("mb-2","print:hidden"),o.classList.add("w-1/2","flex","flex-col","border-black","border-2","rounded-lg","shrink"),n.append(s,r),o.append(n,a),o.addEventListener("dragover",Qt),o.addEventListener("dragenter",Jt),o.addEventListener("dragleave",Xt),o.addEventListener("drop",Zt),o}function z(t=""){const e=p("#page_title");if(typeof t=="string")return e.innerHTML=t;if(typeof t=="object")return e.append(t)}async function Wt(){const[t,e,o,n]=location.hash.split("/");Yt(`${o}-${n}`);const s=await S(`${E}${o}/${n}`),{fotosEmpezar:a,fotosTerminar:r,sitio:i}=s;if(a.length<2||r.length<2)return x("apendeje","No Hay Fotos",`/upfotos/${o}/${n}/${i}`);const d=tt(a,"Inicio"),l=tt(r,"Final"),u=c("div"),g=c("section");g.id="creareporte",g.classList.add("mt-1","flex","px-2","space-x-2","fixed","items-start","print:justify-around","print:absolute");const f=p("#preview"),b=Kt();return f.addEventListener("click",w=>{window.print()}),p("#save").addEventListener("click",()=>{te(b,o,n)}),g.append(d,b,l),u.append(g),u}function Yt(t){const e=`<div class="flex justify-evenly"><p>Proyecto: ${t}</p><button type="button" id="preview" class="bg-orange-500  w-20 text-xs rounded">Preview</button></p><button type="button" id="save" class="bg-blue-500  w-20 text-xs rounded">Save</button></div>`;return z(e)}async function te(t,e,o){const n={grupo1:{},grupo2:{}};return[...t.querySelectorAll("img")].forEach(i=>{const[d,l,u]=i.dataset.grp.split("-");n[d][l]=i.src}),await k(At,{cotizacionId:e,proyectoId:o,reporte:n}),location.hash=`${Bt}${e}/${o}`}async function et(t){const e=await S(`${Q}/${t}`);if(e.error){x("apendeje",`Apendeje: ${e.message}`);return}return localStorage.setItem("cotId",JSON.stringify(e)),location.hash="/modifica"}const ee=`<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
</svg>`;function ot(t,e="..."){const o=c("div");o.classList.add("flex","border","rounded-lg","border-gray-500","mb-2");const n=c("input");n.classList.add("w-full","focus:outline-none","pl-1","text-gray-500","rounded-l-lg","border-gray-500","focus:border-blue-500","focus-border-1","focus:ring-1","focus:ring-blue-500"),n.id="search",n.autofocus=!0,n.required=!0,n.placeholder=e,n.autocomplete="off";const s=c("button");return s.innerHTML=`${ee}`,s.classList.add("h-8","w-8","bg-sky-400","rounded-r-lg","flex","items-center","justify-center","text-white"),s.addEventListener("click",t),n.addEventListener("change",t),o.append(n,s),o}function oe(){const t=c("section");t.classList.add("sm:w-1/3","mx-auto");const e=()=>et(p("#search").value);return t.append(ot(e)),t}function nt(){const e=c("section",{class:["mx-2","grid","gap-2","grid-cols-1","sm:grid-cols-1","md:grid-cols-2","lg:grid-cols-3"]});return e.addEventListener("click",async o=>{if(o.target.dataset.cot){const n=o.target.dataset.cot;return et(n)}if(o.target.dataset.cliente)return location.hash=`/cotizaciones/${o.target.dataset.cliente}`;if(o.target.dataset.sitcot){const n=o.target.dataset.sitcot;return location.hash=`/proyectosencotizacion/${n}`}if(o.target.dataset.pry)return location.hash=`/mod-proyecto/${o.target.dataset.pry}`;if(o.target.dataset.reporte){const n=o.target.dataset.reporte;location.hash=`/verReporte/${n}`}if(o.target.dataset.crear){const n=o.target.dataset.crear;location.hash=`/reporte/${n}`}if(o.target.dataset.subir){const n=o.target.dataset.subir;location.hash=`/upfotos/${n}`}}),e}function M(t,e){const n=c("button",{class:["text-blue-900","hover:text-white","focus:text-white","bg-blue-400","hover:bg-blue-500","focus:ring-4","focus:ring-blue-300","font-medium","rounded-full","text-xs","px-2","text-center","mx-2","mb-2","h-6","w-1/3","border-b-2","border-r-2","border-blue-900","truncate"],dataset:e});return n.innerText=t,n}function $(...t){const o=c("div",{class:["pt-2","flex","justify-between"]});return o.append(...t),o}function m(t,e){const o={class:["mx-2","mb-2","space-y-1","bg-blue-800","p-2","rounded","w-full","text-white","text-xs"]},n={text:t},s={text:e},a=c("div",o),r=c("p",n),i=c("p",s);return a.append(r,i),a}function A(){return c("section",{class:["w-full","mx-auto","space-y-2","bg-slate-200","rounded-lg","border-2","border-blue-500"]})}function ne(t){const{cotizacionId:e,cliente:o,contacto:n,trabajo:s,sitios:a,cotizador:r,monto:i,status:d,emision:l,resuelta:u,pedido:g}=t,f=A(),b=$(M(`Cot: ${e}`,{cot:e}),M(`${o}`,{cliente:o}),M(`Sitios ${a}`,{sitcot:e})),h=$(m("Trabajo:",`${s}`));h.classList.add("w-full");const w=$(m("Status:",`${d}`),m("Emision",`${y(l)}`),m("Resolucion:",`${y(u)}`));return f.append(b,h,w),f}async function st(t){const e=t||"";z(e!==""?`Cotizaciones de ${e}`:"Todas las Cotizaciones ");const o=await S(`${_}/${e}`),n=o.length>0?o:[o],s=nt(),a=n.map(r=>ne(r));return s.append(...a),s}function se(t){const e=A(),o=t.reporte.length,n=t.fotosEmpezar.length,s=t.fotosTerminar.length,a=`${t.cotizacionId}/${t.proyectoId}/${t.sitio}`,r=o>0?"reporte":n>=2&&s>=2?"crear":"subir",i=$(M(`Pry: ${t.cotizacionId}-${t.proyectoId}`,{pry:`${t.cotizacionId}/${t.proyectoId}`}),M(`Reporte(${o})`,{[r]:a})),d=$(m("Sitio",t.sitio),m("Supervisor",t.supervisor)),l=$(m("Direccion",t.direccion)),u=$(m("Status",t.status),m("Inicio",y(t.inicio))),g=$(m("Terminado",y(t.terminado)),m("Factura",t.factura));return e.append(i,d,l,u,g),e}async function ae(t){const e=await S(`${E}${t}`),o=e.length>0?e:[e],n=nt(),s=o.map(a=>se(a));return z(`Trabajo: ${o[0].trabajo} <br class="sm:hidden"><span class="ml-4">Cliente: ${o[0].cliente}</span>`),n.append(...s),n}function at(t){return c("h4",{class:["mx-2","py-1","text-center","rounded","bg-blue-800","text-white","w-1/2"],text:t})}function rt(t,e,o){t!=="terminado"?(e.classList.add("hidden"),o.classList.add("hidden")):(e.classList.remove("hidden"),o.classList.remove("hidden"))}async function re(t,e,o){const n=await K(o);try{const s=await k(`${Ft}${t}/${e}`,n);x("bien",`Proyecto ${t}-${e} ${s.message}`,`/proyectosencotizacion/${t}`);return}catch(s){x("apendeje",`Apendeje : ${s.message}`)}}const ce=[{val:"pendiente",title:"Pendiente"},{val:"proceso",title:"Proceso"},{val:"terminado",title:"Terminado"}];async function ie(){const[t,e,o,n]=location.hash.split("/"),s=await S(`${E}${o}/${n}`),a=$(at(`Proyecto: ${o}-${n}`),at(`Cliente: ${s.cliente}`)),r=$(m("Trabajo",s.trabajo)),i=C(v("sitio","text","Sitio",s.sitio),v("direccion","text","direccion",s.direccion)),d=C(v("supervisor","text","supervisor",s.supervisor),G("status","Status",ce,s.status),v("inicio","date","Inicio",y(s.inicio))),l=v("terminado","date","Terminacion",y(s.terminado)),u=v("factura","text","factura",s.factura),g=C(l,u),f=$(T({type:"cancel",cb:()=>console.log("BTN")}),T({type:"save",cb:async w=>(w.preventDefault(),re(o,n,h))})),b=A(),h=c("form");return b.classList.add("sm:w-2/3"),h.classList.add("space-y-2","p-2","mx-auto"),h.setAttribute("autocomplete","off"),h.append(i,d,g,f),h.addEventListener("change",w=>{rt(h.status.value,l,u)}),b.append(a,r,h),rt(h.status.value,l,u),b}function de(t){const o=c("section",{class:["space-y-2"],id:"top"}),n=t.map((s,a)=>{const{cotizacionId:r,proyectoId:i,sitio:d,direccion:l}=s,u=A();u.classList.add("cursor-pointer"),u.dataset.cardnum=a,u.dataset.pry=`${r}/${i}/${d}`;const g=$(m("Proyecto",`${r}-${i}`),m("Sitio",`${d}`)),f=$(m("Direccion",`${l}`));return u.append(g,f),u});return o.append(...n),o.addEventListener("click",s=>{const a=parseInt(s.target.closest("section").dataset.cardnum,10),{pry:r}=s.target.closest("section").dataset;r&&location.hash.includes("fotos")&&(location.hash=`/upfotos/${r}`),r&&location.hash.includes("make_report")&&(localStorage.setItem("pry",JSON.stringify(t[a])),location.hash=`/reporte/${r}`)}),o}function ct(t){t.includes("make_report")&&z("Crear Reporte (sitio o direccion)"),t.includes("fotos")&&z("Capturar Fotos  (sitio o direccion)");const e=c("section");e.classList.add("sm:w-1/2","mx-auto","pt-6");const o=async()=>{const n=p("#search").value;if(p("#top")&&p("#top").remove(),!n)return;const s=await S(`${Mt}?val=${n}`),a=s.length>1?s:[s],r=de(a);e.append(r)};return e.append(ot(o)),e}function it(t="foto",e="final",o=!1){const n=c("div");n.classList.add("flex","items-center","space-x-8","bg-blue-700","rounded-full","text-sm","h-8","pr-2");const s=c("label"),a=c("input");return a.type="radio",a.name=t,a.id=e,a.value=e,a.classList.add("w-4","h-4","accent-red-600"),a.checked=o,s.setAttribute("for",e),s.classList.add("ml-4"),s.innerText=e.toUpperCase(),n.append(s,a),n}function le(t){const e=p("figure"),o=p("#imgdiv"),n=p("#btnbar");o.classList.add("hidden"),n.classList.remove("invisible"),e.innerHTML=`<img src="${t.target.result}">`}function ue(){const t=c("div");t.id="imgdiv",t.classList.add("flex","justify-center");const e=c("input");e.type="file",e.id="foto",e.name="foto",e.classList.add("hidden");const o=c("label");return o.setAttribute("for","foto"),o.innerHTML=vt,o.classList.add("block","flex","items-center","justify-center","w-24","h-24","rounded-full","border","border-black","cursor-pointer"),e.addEventListener("change",async n=>{const s=await n.target.files[0];if(!s)return;const a=new FileReader;a.readAsDataURL(s),a.addEventListener("load",le,!1)}),o.append(e),t.append(o),t}async function pe(t,e){const o=new FormData;return Object.keys(t).forEach(n=>o.append(n,t[n])),o.append("Content-type",e.type),o.append("file",e),o}async function fe(t,e){const o=localStorage.getItem("TKT"),n={method:"POST",body:e,headers:{Authentication:`Bearer ${o}`}};try{return await fetch(t,n)}catch(s){return s.json()}}function ge(t){const e=[...t.getElementsByTagName("input")],[o]=e.filter(n=>n.checked);return o?o.value:Error("te Apendejaste falta foto tipo")}async function he(t,e,o,n){const s={cotizacionId:t,proyectoId:e,fileName:n.name};try{const a=ge(o);if(!["empezar","terminar"].includes(a))throw Error(a.message);const r=await k(Et,s);if(r.statusCode)throw Error(r.message);const{url:i,fields:d}=r,l=await pe(d,n);if(!(await fe(i,l)).ok)throw Error("error al subir foto");const g={cotizacionId:t,proyectoId:e,tipo:a,laFoto:d.key};return await k(It,g)}catch(a){return a}}function dt(t,e){const o=p("figure"),n=p("#imgdiv"),s=p("#btnbar"),a=p("#upfotos");s.classList.add("invisible"),t==="positive"&&(o.innerHTML=`${$t}<p class="text-teal-700">${e}!!!</p>`),t==="negative"&&(o.innerHTML=`${wt}<p class="text-red-700">!!!${e}</p>`),setTimeout(()=>{a.reset(),o.innerHTML=null,n.classList.remove("hidden")},1500)}async function me(t,e){const{cotizacionId:o,proyectoId:n,$radioBar:s}=e,a=new FileReader;a.readAsDataURL(t);const r=c("canvas"),i=r.getContext("2d"),d=c("img");d.id="small",d.classList.add("hidden"),a.addEventListener("load",l=>{d.src=l.target.result}),d.addEventListener("load",async l=>{const u=400,g=p("#imgcontainer"),{width:f,height:b}=l.target,h=b/f,w=f>u?u:f,D=w*h;r.width=w,r.height=D,i.drawImage(l.target,0,0,r.width,r.height);const P=i.canvas.toDataURL("image/webp"),pt=await(await fetch(P)).blob(),ft=new File([pt],"CHIQUITO.webp",{type:"image/webp"});g.innerHTML=U;const{message:R}=await he(o,n,s,ft);R.includes("agregado")?dt("positive",R):dt("negative",R)})}function be(){z("Captura de Fotos");const[t,e,o,n,s]=location.hash.split("/"),a=ue(),r=c("figure");r.id="imgcontainer",r.classList.add("text-center","mx-auto"),r.innerHTML=null;const i=c("form");i.id="upfotos",i.autocomplete="off",i.classList.add("mx-2","mt-2","sm:w-2/3","sm:mx-auto","space-y-8","bg-blue-100","border-blue-500","text-white","rounded-lg");const d=m("Proyecto : ",`${o}-${n}`),l=m("Sitio :",decodeURI(s)),u=$(d,l),g=C(it("foto","empezar"),it("foto","terminar"));g.classList.add("flex","justify-center","space-x-2");const f=C(T({type:"cancel",cb:()=>{i.reset(),r.innerHTML=null,a.classList.remove("hidden"),f.classList.add("invisible")}}),T({type:"save",cb:async b=>{const h=p("#foto").files[0];await me(h,{cotizacionId:o,proyectoId:n,$radioBar:g})}}));return f.id="btnbar",f.classList.add("flex","justify-center","space-x-12","invisible"),i.append(u,g,a,r,f),i}const F={currentVal:1};function ve(t,e){F.Max=t;const o={class:["flex","space-x-1","border","border-black","rounded-lg","mr-6","p-2"]},n={html:yt,id:"minus"},s={html:xt,id:"plus"},a={class:["w-6","h-6","mb-1","rounded","text-center","text-blue-800"],id:"contador",type:"text",value:1},r=c("div",o),i=c("button",s),d=c("input",a),l=c("button",n);return i.addEventListener("click",u=>lt(u,e)),l.addEventListener("click",u=>lt(u,e)),r.append(l,d,i),r}function lt(t,e){let o=0;t.target.closest("#plus")&&(o=1),t.target.closest("#minus")&&(o=-1);const n=p("#reporte"),s=p("#fecha"),a=p("#contador"),r=$e(o);n.innerText=`Reporte # ${r}`,a.value=r,s.innerText=` Fecha: ${y(e[r-1].header.createdDate)}`;for(const i in e[r-1]){if(i==="header")break;for(const d in e[r-1][i]){const l=p(`#${i}-${d}`);l.src=e[r-1][i][d]}}}function $e(t){let e=F.currentVal+t;return e>F.Max&&(e=1),e<1&&(e=F.Max),F.currentVal=e,F.currentVal}function we([t,...e]){return[t.toUpperCase(),...e].join("")}function H(...t){const e=c("div",{class:["flex","justify-evenly"]}),o=t.map(n=>{const[s]=Object.entries(n);return c("p",{id:`${s[0]}`,class:["text-sm","truncate"],text:`${we(s[0])}: ${s[1]}`})});return e.append(...o),e}function xe(t=1,e){const o=t-1,n=c("section",{class:["space-y-2","pb-2","border-b-2","border-black"]}),s=c("p",{html:`${q} RgcIngenieria`,class:["flex","text-sm","ml-2"]}),a=c("h4",{text:"Reporte Fotografico",class:["text-lg","text-center"]}),r=H({proyecto:`${e.cotizacionId}-${e.proyectoId}`},{reporte:t},{sitio:e.sitio},{trabajo:e.trabajo}),i=H({cliente:e.cliente},{pedido:e.pedido},{contacto:e.contacto}),d=H({supervisor:e.supervisor},{factura:e.factura}),l=c("p",{id:"fecha",text:`Fecha: ${y(e.reporte[o].header.createdDate)}`,class:["text-sm","mr-2"]}),u=c("div",{class:["flex","justify-between"]});return u.append(s,l),n.append(u,a,r,i,d),n}function ye(t){const e=[];for(const o in t){if(o==="header")break;const n=c("section",{class:["flex","justify-between","space-x-2"],id:o}),s=[];for(const a in t[o]){const r=c("figure",{class:["w-1/2","border-black","border-2","rounded-lg","shrink"]}),i=c("img",{src:`${t[o][a]}`,class:["object-scale-down","mx-auto","h-64","mb-2"],id:`${o}-${a}`}),d=c("figcaption",{text:`Foto ${a.toUpperCase()} ${e.length+1}`,class:["ml-2"]});r.append(d,i),s.push(r)}n.append(...s),e.push(n)}return e}async function Le(){const[t,e,o,n,s,a]=location.hash.split("/"),r=a?parseInt(a,10)-1:0,i=await S(`${E}${o}/${n}`),{reporte:d}=i;if(i.fotosEmpezar<2||i.fotosTerminar<2)return x("apendeje","Fotos Incompletas",`/upfotos/${o}/${n}/${s}`);if(d.length<1)return x("apendeje","No Hay reportes",`/reporte/${o}/${n}`);const l=p("#action"),u=c("section",{id:"reporte-total",class:["space-y-2","mx-2"]});return l.append(ve(d.length,d)),u.append(xe(1,i),...ye(d[r])),u}function ke(){return localStorage.removeItem("tkt"),j.logout({returnTo:"https://mibuen.github.io/serviciosrgc.github.io"})}const O=[{link:"#/",titulo:"Home",cb:()=>jt()},{link:"#/logout",titulo:"Logout",cb:()=>ke()},{link:"#/cotizacion",titulo:"Nueva Cotizacion",cb:async()=>Y()},{link:"#/mod-cot",titulo:"Modificar Cotizacion",cb:async()=>oe()},{link:"#/modifica",titulo:"",cb:async t=>Y()},{link:"#/cotizaciones",titulo:"Listado Cotizaciones",cb:(t="")=>st(t)},{link:"#/cotizacionesxcliente",titulo:"",cb:()=>st()},{link:"#/proyectosencotizacion",titulo:"",cb:t=>ae(t)},{link:"#/mod-proyecto",titulo:"",cb:t=>ie()},{link:"#/fotos",titulo:"Agregar Fotos",cb:()=>ct("fotos")},{link:"#/upfotos",titulo:"",cb:()=>be()},{link:"#/make_reporte",titulo:"Reporte Final",cb:()=>ct("make_reporte")},{link:"#/reporte",titulo:"",cb:()=>Wt()},{link:"#/verReporte",titulo:"",cb:async()=>Le()}];function Ce(){const e=c("nav",{id:"navLinks",class:["hidden","w-auto","fixed","mt-2","left-0","bg-blue-800","space-y-2"]});return O.forEach(({titulo:o,link:n})=>{o!==""&&e.append(Ct(n,o))}),e}async function je(){const e=c("header",{class:["bg-green-800","h-16","px-2","pt-4","fixed","inset-x-0","top-0","z-10","print:hidden"]});return e.append(await kt(),Ce()),e}function Te(t=""){const e=c("div");return e.id="alert",e.classList.add("h-16","rounded","border","text-center","text-xl","hidden","fixed","left-1/4","top-1/4","w-1/2","z-10"),e.innerText=t,e}async function B(t){const o=c("section",{id:"content",class:["mt-16","w-full","print:mt-0"]});return typeof t=="object"&&o.append(t),o}function Se(){const t=c("div");return t.classList.add("text-center","text-6xl","text-blue-500"),t.innerText="Te Chingas Not found PlaceHolder",t}async function ze(t){if(t==="/"||!t){const a=await B(O[0].cb());return L.append(a),L}const e=t.split("/"),o=e.length>2?`${e[0]}/${e[1]}`:t,n=O.find(a=>a.link===o);if(e[2])return L.append(await B(await n.cb(e[2])));if(!n)return L.append(await B(Se()));const s=await B(await n.cb());return L.append(s)}const Fe=t=>t.classList.toggle("hidden"),Me=t=>Array.from(t.querySelectorAll("path")).forEach(o=>{o.classList.toggle("hidden")});async function Ee(){return j.loginWithRedirect({redirect_uri:"https://mibuen.github.io/serviciosrgc.github.io"})}async function Ie(){const t=p("#navLinks"),e=p("#menuBtn");L.addEventListener("click",async o=>{if(await j.isAuthenticated()===!1)return Ee();(!t.classList.contains("hidden")||o.target.closest("#menuBtn")&&!o.target.closest("a"))&&(Fe(t),Me(e))},!0)}async function ut(){return L.innerHTML=null,L.append(await je(),Pt()),L.append(Te()),Ie(),ze(window.location.hash)}async function Ae(){const t=window.location.search;if(t.includes("code=")&&t.includes("state=")){await j.handleRedirectCallback();const e=await j.getTokenSilently();return localStorage.setItem("tkt",e),console.log("yaChingamos"),window.history.replaceState({},document.title,"/")}}window.addEventListener("hashchange",async()=>{ut()});document.addEventListener("DOMContentLoaded",async()=>{console.log("Loadding>>>>??"),await Ae(),ut()});
